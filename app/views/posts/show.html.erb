<main class="post__show">
  <% flash.each do |name, msg| %>
    <%= content_tag :div, msg, class: [:home_message, :alert, alert_for(name)] %>
  <% end %>

  <section class="post__wrap">
    <div class="post__image">
      <%= image_tag @post.image %>
    </div>

    <div class="post__data">
      <div class="data__head">
        <div class="username-and-avatar">
          <% if @post.user.avatar.attached? %>
            <%= link_to image_tag(@post.user.avatar, class: "avatar"), user_path(@post.user) %>
          <% else %>
            <%= link_to image_tag('/icons/profile.svg', class: "avatar"), user_path(@post.user) %>
          <% end %>
          <%= link_to @post.user.username, user_path(@post.user), class: "username" %>
        </div>

        <% if @post.user.id == current_user.id %>
          <div class="data__head__icons">
            <%= link_to image_tag('/icons/edit_post.svg'), edit_post_path(@post)%>
            <%= link_to image_tag('/icons/delete.svg'), post_path(@post), method: :delete, data: { confirm: "Are you sure you want to delete this post?" }%>
          </div>
        <% end %>
      </div>

      <div class="data__comments">
        <div class="username-and-avatar comment">
          <% if @post.user.avatar.attached? %>
            <%= link_to image_tag(@post.user.avatar, class: "avatar"), user_path(@post.user) %>
          <% else %>
            <%= link_to image_tag('/icons/profile.svg', class: "avatar"), user_path(@post.user) %>
          <% end %>
          <%= link_to @post.user.username, user_path(@post.user), class: "username" %>
          <span><%= @post.description %></span>
        </div>

        <% @post.comments.each do |comment| %>
          <div class="username-and-avatar comment">
            <% if comment.user.avatar.attached? %>
              <%= link_to image_tag(comment.user.avatar, class: "avatar"), user_path(comment.user) %>
            <% else %>
              <%= link_to image_tag('/icons/profile.svg', class: "avatar"), user_path(comment.user) %>
            <% end %>

            <%= link_to comment.user.username, user_path(comment.user), class: "username" %>
            <span><%= comment.content %></span>
          </div>
        <% end %>
      </div>
      
      <div class="data__icons">
        <a href=""><img src="/icons/like.svg" alt="like" /></a>
        <a href=""><img src="/icons/Comment.svg" alt="comment" /></a>
        <a href=""><img src="/icons/SharePosts.svg" alt="share" /></a>
      </div>

      <div class="data__likes">1069 отметок "Нравится"</div>

      <div class="data__created">
        <time datetime="<%= @post.formatted_created_at %>">
          <%= @post.formatted_created_at %>
        </time>
      </div>

      <%= form_for [@post, @post.comments.new], :html => {:class => 'data__addComment'} do |f| %>
        <img class="emoji" src="/icons/Emoji.svg" alt="Emoji" />
        <%= f.text_area :content, class: 'textarea post', rows: "1", placeholder: "Добавьте комментарий..." %>
        <%= f.submit "Опубликовать", class: 'submit--text user' %>
      <% end %>

    </div>
  </section>
</main>

<%= render "layouts/footer" %>